<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>NetSci Modularity</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script>window.MathJax = {
  tex: {
    inlineMath: [['\\(','\\)']],
    tags: "none",
    useLabelIds: true,
    tagSide: "right",
    tagIndent: ".8em",
    packages: {'[+]': ['base', 'extpfeil', 'ams', 'amscd', 'newcommand', 'knowl']}
  },
  options: {
    ignoreHtmlClass: "tex2jax_ignore",
    processHtmlClass: "has_am",
  },
  chtml: {
    scale: 0.88,
    mtextInheritFont: true
  },
  loader: {
    load: ['input/asciimath', '[tex]/extpfeil', '[tex]/amscd', '[tex]/newcommand', '[pretext]/mathjaxknowl3.js'],
    paths: {pretext: "https://pretextbook.org/js/lib"},
  },
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/jquery.min.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/0.13/pretext.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/0.13/pretext_add_on.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script xmlns:svg="http://www.w3.org/2000/svg">sagecellEvalName='Evaluate (Sage)';
</script><link xmlns:svg="http://www.w3.org/2000/svg" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/pretext.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/pretext_add_on.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/banner_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/toc_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/knowls_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/style_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/colors_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/setcolors.css" rel="stylesheet" type="text/css">
<!-- 2019-10-12: Temporary - CSS file for experiments with styling --><link xmlns:svg="http://www.w3.org/2000/svg" href="developer.css" rel="stylesheet" type="text/css">
</head>
<body class="pretext-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div xmlns:svg="http://www.w3.org/2000/svg" id="latex-macros" class="hidden-content" style="display:none">\(\newcommand{\identity}{\mathrm{id}}
\newcommand{\notdivide}{{\not{\mid}}}
\newcommand{\notsubset}{\not\subset}
\newcommand{\lcm}{\operatorname{lcm}}
\newcommand{\gf}{\operatorname{GF}}
\newcommand{\inn}{\operatorname{Inn}}
\newcommand{\aut}{\operatorname{Aut}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\cis}{\operatorname{cis}}
\newcommand{\chr}{\operatorname{char}}
\newcommand{\Null}{\operatorname{Null}}


\def\Z{\mathbb Z}
\def\R{\mathbb R}
\def\Q{\mathbb Q}
\def\N{{\mathbb N}}
\def\C{\mathbb C}

\def\ba{{\mathbf{a}}}
\def\bb{\mathbf{b}}
\def\bh{{\mathbf{h}}}
\def\bu{{\mathbf{u}}}
\def\bv{{\mathbf{v}}}
\def\bw{{\mathbf{w}}}   
\def\bx{{\mathbf{x}}}
\def\by{\mathbf{y}}    
\def\bone{{\mathbf{1}}}
\def\bzero{\mathbf{0}}

\def\var{{\mbox{var}}}
\def\P{{\mathbb{P}}}
\def\E{{\mathbb{E}}}


\def\cA{{\overline{A}}}

\def\kin{k^{\mathrm{in}}}
\def\kout{k^{\mathrm{out}}}

\newcommand{\indeg}[1]{k^{\mathrm{in}}_{#1}}
\newcommand{\outdeg}[1]{k^{\mathrm{out}}_{#1}}

\tikzset{-&gt;-/.style={decoration={
 markings,
 mark=at position .5 with {\arrow{latex}}},postaction={decorate}}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="netsci.html"><span class="title">Network Science:</span> <span class="subtitle">Activities and Exercises</span></a></h1>
<p class="byline">Andrew Beveridge</p>
</div>
</div></div>
<nav xmlns:svg="http://www.w3.org/2000/svg" id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="us-airline.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="part-structure.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="communities.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="us-airline.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="part-structure.html" title="Up">Up</a><a class="next-button button toolbar-item" href="communities.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div xmlns:svg="http://www.w3.org/2000/svg" id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link frontmatter"><a href="frontmatter.html" data-scroll="frontmatter"><span class="title">Front Matter</span></a></li>
<li class="link part"><a href="part-structure.html" data-scroll="part-structure"><span class="codenumber">I</span> <span class="title">Network Structure</span></a></li>
<li class="link">
<a href="graphs.html" data-scroll="graphs"><span class="codenumber">1</span> <span class="title">Graphs and Digraphs</span></a><ul><li><a href="exercises-1.html" data-scroll="exercises-1">Practice Problems</a></li></ul>
</li>
<li class="link">
<a href="centrality.html" data-scroll="centrality"><span class="codenumber">2</span> <span class="title">Centrality Measures</span></a><ul><li><a href="exercises-2.html" data-scroll="exercises-2">Practice Problems</a></li></ul>
</li>
<li class="link">
<a href="algcentrality.html" data-scroll="algcentrality"><span class="codenumber">3</span> <span class="title">Algebraic Centrality</span></a><ul><li><a href="exercises-3.html" data-scroll="exercises-3">Practice Problems</a></li></ul>
</li>
<li class="link">
<a href="randomwalk.html" data-scroll="randomwalk"><span class="codenumber">4</span> <span class="title">Random Walks</span></a><ul><li><a href="exercises-4.html" data-scroll="exercises-4">Practice Problems</a></li></ul>
</li>
<li class="link">
<a href="hits.html" data-scroll="hits"><span class="codenumber">5</span> <span class="title">Hubs and Authorities</span></a><ul><li><a href="exercises-5.html" data-scroll="exercises-5">Practice Problems</a></li></ul>
</li>
<li class="link">
<a href="us-airline.html" data-scroll="us-airline"><span class="codenumber">6</span> <span class="title">Analyzing the US Airline Network</span></a><ul><li><a href="exercises-6.html" data-scroll="exercises-6">Practice Problems</a></li></ul>
</li>
<li class="link active">
<a href="modularity.html" data-scroll="modularity"><span class="codenumber">7</span> <span class="title">Modularity</span></a><ul><li><a href="exercises-7.html" data-scroll="exercises-7">Practice Problems</a></li></ul>
</li>
<li class="link">
<a href="communities.html" data-scroll="communities"><span class="codenumber">8</span> <span class="title">Community Detection in Gephi</span></a><ul><li><a href="exercises-8.html" data-scroll="exercises-8">Practice Problems</a></li></ul>
</li>
<li class="link">
<a href="randvar.html" data-scroll="randvar"><span class="codenumber">9</span> <span class="title">Discrete Random Variables</span></a><ul>
<li><a href="randvar0.html" data-scroll="randvar0">Discrete Random Variables</a></li>
<li><a href="randvar3.html" data-scroll="randvar3">Events</a></li>
<li><a href="randvar6.html" data-scroll="randvar6">CDF and CCDF</a></li>
<li><a href="randvar10.html" data-scroll="randvar10">Expectation, Variance and Moments</a></li>
<li><a href="randvar16.html" data-scroll="randvar16">Famous Discrete Distributions</a></li>
</ul>
</li>
<li class="link">
<a href="probdist.html" data-scroll="probdist"><span class="codenumber">10</span> <span class="title">Probability Distributions</span></a><ul><li><a href="exercises-9.html" data-scroll="exercises-9">Practice Problems</a></li></ul>
</li>
<li class="link">
<a href="powerlaw.html" data-scroll="powerlaw"><span class="codenumber">11</span> <span class="title">Power Laws</span></a><ul><li><a href="exercises-10.html" data-scroll="exercises-10">Practice Problems</a></li></ul>
</li>
<li class="link part"><a href="part-models.html" data-scroll="part-models"><span class="codenumber">II</span> <span class="title">Network Models</span></a></li>
<li class="link">
<a href="giantcomp.html" data-scroll="giantcomp"><span class="codenumber">12</span> <span class="title">The Emergence of the Giant Component</span></a><ul><li><a href="exercises-11.html" data-scroll="exercises-11">Practice Problems</a></li></ul>
</li>
<li class="link">
<a href="pricemodel.html" data-scroll="pricemodel"><span class="codenumber">13</span> <span class="title">Price's Model for a Citation Network</span></a><ul><li><a href="exercises-12.html" data-scroll="exercises-12">Practice Problems</a></li></ul>
</li>
<li class="link">
<a href="smallworld.html" data-scroll="smallworld"><span class="codenumber">14</span> <span class="title">The Small World Model</span></a><ul><li><a href="exercises-13.html" data-scroll="exercises-13">Practice Problems</a></li></ul>
</li>
<li class="link">
<a href="navsmallworld.html" data-scroll="navsmallworld"><span class="codenumber">15</span> <span class="title">Navigable Small World Model</span></a><ul><li><a href="exercises-14.html" data-scroll="exercises-14">Practice Problems</a></li></ul>
</li>
<li class="link part"><a href="part-processes.html" data-scroll="part-processes"><span class="codenumber">III</span> <span class="title">Processes on Networks</span></a></li>
<li class="link">
<a href="cascades.html" data-scroll="cascades"><span class="codenumber">16</span> <span class="title">Network Cascades</span></a><ul><li><a href="exercises-15.html" data-scroll="exercises-15">Practice Problems</a></li></ul>
</li>
<li class="link">
<a href="epidemics.html" data-scroll="epidemics"><span class="codenumber">17</span> <span class="title">Epidemics on Networks</span></a><ul><li><a href="exercises-16.html" data-scroll="exercises-16">Practice Problems</a></li></ul>
</li>
<li class="link part"><a href="part-homework.html" data-scroll="part-homework"><span class="codenumber">IV</span> <span class="title">Homework Exercises</span></a></li>
<li class="link">
<a href="hw-graphs.html" data-scroll="hw-graphs"><span class="codenumber">18</span> <span class="title">Exercises: Graphs and Digraphs</span></a><ul><li><a href="exercises-17.html" data-scroll="exercises-17">Homework Exercises</a></li></ul>
</li>
<li class="link">
<a href="hw-centrality.html" data-scroll="hw-centrality"><span class="codenumber">19</span> <span class="title">Exercises: Centrality Measures</span></a><ul><li><a href="exercises-18.html" data-scroll="exercises-18">Homework Exercises</a></li></ul>
</li>
<li class="link">
<a href="hw-degreedist.html" data-scroll="hw-degreedist"><span class="codenumber">20</span> <span class="title">Exercises: Degree Distributions and Power Laws</span></a><ul><li><a href="exercises-19.html" data-scroll="exercises-19">Homework Exercises</a></li></ul>
</li>
</ul></nav><div class="extras"><nav><a class="pretext-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section xmlns:svg="http://www.w3.org/2000/svg" class="chapter" id="modularity"><h2 class="heading">
<span class="type">Chapter</span> <span class="codenumber">7</span> <span class="title">Modularity</span>
</h2>
<section class="introduction" id="introduction-7"><p id="p-267">Suppose that we have a network that is partitioned into (potential) communities. The <em class="emphasis">type</em> of a vertex is the community \(C\) that it belongs to. The <em class="emphasis">modularity</em> of a network \(G\) is given by</p>
<div class="displaymath">
\begin{equation*}
Q  =  \frac{1}{2m} \sum_{i} \sum_{j} \left( A_{ij} - \frac{k_i k_j}{2m} \right) \delta (C^{(i)}, C^{(j)})
=  \frac{1}{2m} \sum_{C} \sum_{i \in C} \sum_{j \in C} \left( A_{ij} - \frac{k_i k_j}{2m} \right)
\end{equation*}
</div>
<p class="continuation">where</p>
<ul class="disc">
<li id="li-147"><p id="p-268">\(A\) is the adjacency matrix</p></li>
<li id="li-148"><p id="p-269">\(m\) is the number of edges in the network</p></li>
<li id="li-149"><p id="p-270">\(k_i\) is the degree of vertex \(i\)</p></li>
<li id="li-150"><p id="p-271">\(C^{(i)}\) is the <em class="emphasis">type</em> of vertex \(i\)</p></li>
<li id="li-151"><p id="p-272">\(\displaystyle \delta(x,y) = \left\{ \begin{array}{cc} 1 &amp; \mbox{if } x=y \\ 0 &amp;  \mbox{otherwise} \end{array} \right.\)</p></li>
</ul>
<p class="continuation">The modularity satisfies \(-1 &lt; Q &lt; 1\text{.}\) A modularity score of \(Q &gt; 0.3\) indicates significant community structure.</p></section><section class="exercises" id="exercises-7"><h3 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber"></span> <span class="title">Practice Problems</span>
</h3>
<article class="exercise exercise-like" id="exercise-38"><h6 class="heading">
<span class="codenumber">1<span class="period">.</span></span><span class="space"> </span><span class="title">Modularity Calculation.</span>
</h6>
<p id="p-273">Consider the following network with \(V = \{ 1, 2, 3, 4 \}\) and \(E = \{ (1,2), (3,4) \}\text{.}\) Confirm that the modularity scores of the following four partitions by filling in the summands for \(1 \leq i,j \leq 4\text{.}\) Use this <a class="external" href="https://docs.google.com/spreadsheets/d/1kEP0CkUeG9s0RrJDtZcSmkDRKR7JWryNItu4b60pYYs/edit?usp=sharing" target="_blank">link to a Google Sheet</a> to speed up calculations. Pay attention to the modularity contributions for various pairs of nodes. In particular, when \(i\) and \(j\) are in different communities, the corresponding summand is zero.</p>
<ol class="lower-alpha">
<li id="li-152"><p id="p-274">A single community. <div class="image-box" style="width: 40%; margin-left: 30%; margin-right: 30%;"><img src="images/fig-img-modularity0.svg" role="img" class="contained"></div> <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-50" id="solution-50"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-50"><div class="solution solution-like">
<p id="p-275">The terms are</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{c|c|c|c|c}
i \backslash j&amp;  1  &amp; 2 &amp; 3 &amp; 4 \\[.5em]
\hline
1 &amp; -\frac{1}{4} &amp; 1-\frac{1}{4} &amp;-\frac{1}{4}&amp;-\frac{1}{4}\\[.5em]
2 &amp;1-\frac{1}{4} &amp;-\frac{1}{4} &amp;-\frac{1}{4} &amp;-\frac{1}{4} \\[.5em]
3 &amp;-\frac{1}{4} &amp;-\frac{1}{4} &amp;-\frac{1}{4} &amp;1-\frac{1}{4} \\[.5em]
4 &amp;-\frac{1}{4} &amp;-\frac{1}{4} &amp;1-\frac{1}{4} &amp;-\frac{1}{4}
\end{array}
\end{equation*}
</div>
<p class="continuation">and the modularity is</p>
<div class="displaymath">
\begin{equation*}
Q =  \frac{1}{4} \left( 4 - 16 \cdot \frac{1}{4} \right) =0
\end{equation*}
</div>
</div></div></p></li>
<li id="li-153"><p id="p-276">Two communities with no external edges. <div class="image-box" style="width: 40%; margin-left: 30%; margin-right: 30%;"><img src="images/fig-img-modularity1.svg" role="img" class="contained"></div> <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-51" id="solution-51"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-51"><div class="solution solution-like">
<p id="p-277">The terms are</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{c|c|c|c|c}
i \backslash j&amp;  1  &amp; 2 &amp; 3 &amp; 4 \\[0.5em]
\hline
1 &amp; -\frac{1}{4} &amp; 1-\frac{1}{4} &amp;0&amp;0\\[0.5em]
2 &amp;1-\frac{1}{4} &amp;-\frac{1}{4} &amp;0 &amp;0 \\[0.5em]
3 &amp;0&amp;0 &amp;-\frac{1}{4} &amp;1-\frac{1}{4} \\[0.5em]
4 &amp;0 &amp;0&amp;1-\frac{1}{4} &amp;-\frac{1}{4}
\end{array}
\end{equation*}
</div>
<p class="continuation">and the modularity is</p>
<div class="displaymath">
\begin{equation*}
Q =  \frac{1}{4} \left( 4 - 8 \cdot \frac{1}{4} \right) = \frac{1}{2}
\end{equation*}
</div>
</div></div></p></li>
<li id="li-154"><p id="p-278">Two communities with no internal edges. <div class="image-box" style="width: 40%; margin-left: 30%; margin-right: 30%;"><img src="images/fig-img-modularity2.svg" role="img" class="contained"></div> <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-52" id="solution-52"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-52"><div class="solution solution-like">
<p id="p-279">The terms are</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{c|c|c|c|c}
i \backslash j&amp;  1  &amp; 2 &amp; 3 &amp; 4 \\[0.5em]
\hline
1 &amp; -\frac{1}{4} &amp; 0 &amp;-\frac{1}{4} &amp;0\\[0.5em]
2 &amp;0&amp;-\frac{1}{4} &amp;0 &amp;-\frac{1}{4}  \\[0.5em]
3 &amp;-\frac{1}{4} &amp;0 &amp;-\frac{1}{4} &amp;0 \\[0.5em]
4 &amp;0 &amp;-\frac{1}{4} &amp;0 &amp;-\frac{1}{4}
\end{array}
\end{equation*}
</div>
<p class="continuation">and the modularity is</p>
<div class="displaymath">
\begin{equation*}
Q =  \frac{1}{4} \left( 0 - 8 \cdot \frac{1}{4} \right) = -\frac{1}{2}
\end{equation*}
</div>
</div></div></p></li>
<li id="li-155"><p id="p-280">Two communities of sizes 3 and 1. <div class="image-box" style="width: 40%; margin-left: 30%; margin-right: 30%;"><img src="images/fig-img-modularity3.svg" role="img" class="contained"></div> <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-53" id="solution-53"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-53"><div class="solution solution-like">
<p id="p-281">The terms are</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{c|c|c|c|c}
i \backslash j&amp;  1  &amp; 2 &amp; 3 &amp; 4 \\[0.5em]
\hline
1 &amp; -\frac{1}{4} &amp; 1-\frac{1}{4} &amp;-\frac{1}{4}&amp;0\\[0.5em]
2 &amp;1-\frac{1}{4} &amp;-\frac{1}{4} &amp;-\frac{1}{4} &amp;0\\[0.5em]
3 &amp;-\frac{1}{4} &amp;-\frac{1}{4} &amp;-\frac{1}{4} &amp;0 \\[0.5em]
4 &amp;0&amp;0&amp;0 &amp;-\frac{1}{4}
\end{array}
\end{equation*}
</div>
<p class="continuation">and the modularity is</p>
<div class="displaymath">
\begin{equation*}
Q =  \frac{1}{4} \left( 2 - 10 \cdot \frac{1}{4} \right) = -\frac{1}{8}
\end{equation*}
</div>
</div></div></p></li>
</ol></article><article class="exercise exercise-like" id="exercise-39"><h6 class="heading">
<span class="codenumber">2<span class="period">.</span></span><span class="space"> </span><span class="title">Modularity Calculation for a Path.</span>
</h6>
<p id="p-282">Confirm the modularity scored  obtained by splitting the path \(P_4\) into the given communities.</p>
<ol class="lower-alpha">
<li id="li-156"><p id="p-283">A single community. <div class="image-box" style="width: 50%; margin-left: 25%; margin-right: 25%;"><img src="images/fig-img-modularity4.svg" role="img" class="contained"></div> <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-54" id="solution-54"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-54"><div class="solution solution-like">
<p id="p-284">The terms are</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{c|c|c|c|c}
i \backslash j&amp;  1  &amp; 2 &amp; 3 &amp; 4 \\
\hline
1 &amp; - \frac{1}{6}&amp; 1- \frac{2}{6}&amp;- \frac{2}{6}&amp;- \frac{1}{6}\\[0.5em]
2 &amp;1- \frac{2}{6}&amp;- \frac{4}{6}&amp;1- \frac{4}{6}&amp;- \frac{2}{6}\\[0.5em]
3 &amp;- \frac{2}{6}&amp;1- \frac{4}{6}&amp; - \frac{4}{6}&amp;1- \frac{2}{6}\\[0.5em]
4 &amp;- \frac{1}{6}&amp;- \frac{2}{6}&amp;1- \frac{2}{6}&amp;- \frac{1}{6}
\end{array}
\end{equation*}
</div>
<p class="continuation">and the modularity is</p>
<div class="displaymath">
\begin{equation*}
Q =  \frac{1}{6} \left( 6 - 4 \cdot \frac{1}{6} - 8 \cdot \frac{2}{6} - 4 \cdot \frac{4}{6} \right) =
\frac{1}{6} \left( 6 - \frac{18}{3} \right) = 0
\end{equation*}
</div>
</div></div></p></li>
<li id="li-157"><p id="p-285">Two communities separated by the most central edge. <div class="image-box" style="width: 50%; margin-left: 25%; margin-right: 25%;"><img src="images/fig-img-modularity5.svg" role="img" class="contained"></div> <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-55" id="solution-55"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-55"><div class="solution solution-like">
<p id="p-286">The terms are</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{c|c|c|c|c}
i \backslash j&amp;  1  &amp; 2 &amp; 3 &amp; 4 \\[0.5em]
\hline
1 &amp;- \frac{1}{6}&amp; 1 - \frac{2}{6}&amp;0&amp;0\\[0.5em]
2 &amp;1 - \frac{2}{6}&amp;2- \frac{4}{6}&amp;0&amp;0\\[0.5em]
3 &amp;0&amp;0&amp; - \frac{4}{6}&amp; 1- \frac{2}{6}\\[0.5em]
4 &amp;0&amp;0&amp;1 - \frac{2}{6}&amp;- \frac{1}{6}
\end{array}
\end{equation*}
</div>
<p class="continuation">and the modularity is</p>
<div class="displaymath">
\begin{equation*}
Q =  \frac{1}{6} \left( 4 - 2 \cdot \frac{1}{6} - 4 \cdot \frac{2}{6} - 2 \cdot \frac{4}{6} \right) = \frac{1}{6}
\end{equation*}
</div>
</div></div></p></li>
</ol></article><article class="exercise exercise-like" id="exercise-40"><h6 class="heading"><span class="codenumber">3<span class="period">.</span></span></h6>
<p id="p-287">Use this <a class="external" href="https://docs.google.com/spreadsheets/d/1kEP0CkUeG9s0RrJDtZcSmkDRKR7JWryNItu4b60pYYs/edit?usp=sharing" target="_blank">link to a Google Sheet</a> to explore the ways to partition graphs on four vertices. <em class="emphasis">You may add self-loops</em>, but such a loop corresponds to \(A_{ii}=2\) (so that the degrees are correct).</p>
<ol class="lower-alpha">
<li id="li-158"><p id="p-288">Can you find a graph and a partition with modularity greater than \(1/2\text{?}\) If not, why not? <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-56" id="solution-56"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-56"><div class="solution solution-like">
<p id="p-289">Yes, you can. Using loops and communities of size 1 is the key. In fact, a graph with a loop at each vertex that is split into four singleton communities leads to the calculation</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{c|c|c|c|c}
i \backslash j&amp;  1  &amp; 2 &amp; 3 &amp; 4 \\[0.5em]
\hline
1 &amp;2 - \frac{1}{2}&amp;0&amp;0&amp;0\\[0.5em]
2 &amp;0&amp;2 - \frac{1}{2} &amp;0&amp;0\\[0.5em]
3 &amp;0&amp;0&amp;2 - \frac{1}{2}&amp;0 \\[0.5em]
4 &amp;0&amp;0&amp;0&amp;2 - \frac{1}{2}
\end{array}
\end{equation*}
</div>
<p class="continuation">so the modularity is</p>
<div class="displaymath">
\begin{equation*}
Q =  \frac{1}{8} \cdot 4 \left(2 -  \frac{1}{2} \right) = \frac{3}{4}
\end{equation*}
</div>
</div></div></p></li>
<li id="li-159"><p id="p-290">Can you find a graph and a partition with modularity less than \(-1/2\text{?}\) If not, why not? <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-57" id="solution-57"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-57"><div class="solution solution-like">
<p id="p-291">No, you cannot. In order to maximize modularity, you want all the edges to be external to your communities. So the only question is: how many communities should we have? Here are the results from the possibilities for community sizes. All edges between communities are present.</p>
<ul class="disc">
<li id="li-160"><p id="p-292">One community with 4 vertices has \(Q=0\) (or maybe \(Q\) is undefined for the empty graph?)</p></li>
<li id="li-161"><p id="p-293">Two communities: \((3, 1)\) has \(Q = -1/2\)</p></li>
<li id="li-162"><p id="p-294">Two communities: \((2,2)\) has  \(Q=-1/2\)</p></li>
<li id="li-163"><p id="p-295">Three communities: \((2,1,1)\) has \(Q= -17/50\)</p></li>
<li id="li-164"><p id="p-296">Four communities: \((1,1,1,1)\) has \(Q=0\)</p></li>
</ul>
</div></div></p></li>
</ol></article><article class="exercise exercise-like" id="exercise-41"><h6 class="heading">
<span class="codenumber">4<span class="period">.</span></span><span class="space"> </span><span class="title">Understanding Modularity, Part I.</span>
</h6>
<p id="p-297">Modularity measures the extent to which edges are internal to communities, compared with spanning different communities. We will explain why this is the case. Basically, we are comparing the actual structure of the network with the expected structure of a network where we randomize the edges (but preserve the vertex degrees).</p>
<ol class="lower-alpha">
<li id="li-165">
<p id="p-298">Explain why the following expression counts the total number of edges</p>
<div class="displaymath">
\begin{equation*}
\frac{1}{2} \sum_{i}  \sum_{j}  A_{ij} 
\end{equation*}
</div>
<p class="continuation"><a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-58" id="solution-58"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-58"><div class="solution solution-like"><p id="p-299">When we sum all of the entries of the adjacency matrix, we  count every edge twice.</p></div></div></p>
</li>
<li id="li-166">
<p id="p-300">Now explain why the following expression counts the total number of edges that are <em class="emphasis">internal</em> to one of the designated communities.</p>
<div class="displaymath">
\begin{equation*}
\frac{1}{2}  \sum_{i}  \sum_{j} A_{ij}  \, \delta (C^{(i)}, C^{(j)})
\end{equation*}
</div>
<p class="continuation">which can also be written as</p>
<div class="displaymath">
\begin{equation*}
\frac{1}{2} \sum_{C} \sum_{i \in C} \sum_{j \in C} A_{ij}.
\end{equation*}
</div>
<p class="continuation"><a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-59" id="solution-59"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-59"><div class="solution solution-like"><p id="p-301">The Kronecker delta function is 1 when \(i,j\) are in the same community and it is 0 otherwise. So we only count internal edges of communities. The sum counts each of these edges twice.</p></div></div></p>
</li>
</ol></article><article class="exercise exercise-like" id="exercise-42"><h6 class="heading">
<span class="codenumber">5<span class="period">.</span></span><span class="space"> </span><span class="title">Understanding Modularity, Part II.</span>
</h6>
<p id="p-302">Now we will randomly rewire the network. We keep the ends of the edges, so that the vertex degrees do not change (see the figure to the right). We erase the edges themselves, which gives us a configuration like the one pictured to the right. Next, we randomly add edges between pairs of vertices, until all edges have been redrawn. Loops are allowed, as are multiple edges between pairs of vertices.</p>
<p id="p-303">Note that the degree of vertex \(i\) will still be \(k_i\) when this process is done. <div class="image-box" style="width: 40%; margin-left: 30%; margin-right: 30%;"><img src="images/rewire-vertex.png" class="contained"></div></p>
<ol class="lower-alpha">
<li id="li-167"><p id="p-304">Pick the start of one edge at vertex \(i\text{.}\) What is the probability that this rewired edge connects to vertex \(j\text{?}\) <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-60" id="solution-60"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-60"><div class="solution solution-like">
<p id="p-305">The probability is really</p>
<div class="displaymath">
\begin{equation*}
\frac{k_j}{2m-1}
\end{equation*}
</div>
<p class="continuation">but this is basically the same as</p>
<div class="displaymath">
\begin{equation*}
\frac{k_j}{2m}
\end{equation*}
</div>
<p class="continuation">for a very large network.</p>
</div></div></p></li>
<li id="li-168"><p id="p-306">So how many rewired edges from vertex \(i\) do we expect to connect to vertex \(j\text{?}\) (Assume that the network is so big that the chance that two ends at \(i\) try to connect  to the same end at \(j\) is irrelevant.) <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-61" id="solution-61"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-61"><div class="solution solution-like">
<p id="p-307">The expected number of such edges is really</p>
<div class="displaymath">
\begin{equation*}
k_i \frac{k_j}{2m-1}
\end{equation*}
</div>
<p class="continuation">but this is basically the same as</p>
<div class="displaymath">
\begin{equation*}
\frac{k_i k_j}{2m}
\end{equation*}
</div>
<p class="continuation">for a very large network. Essentially, what we are doing is ignoring the probability that we pick the same endpoint twice.</p>
</div></div></p></li>
<li id="li-169">
<p id="p-308">Now argue that the expected number of rewired edges that are internal to the specified communities is</p>
<div class="displaymath">
\begin{equation*}
\frac{1}{2} \sum_{i}  \sum_{j}  \frac{k_i k_j}{2m} \, \delta (C^{(i)}, C^{(j)})
\end{equation*}
</div>
<p class="continuation">which can also be written as</p>
<div class="displaymath">
\begin{equation*}
\frac{1}{2} \sum_{C} \sum_{i \in C} \sum_{j \in C}  \frac{k_i k_j}{2m}.		
\end{equation*}
</div>
<p class="continuation">Here, the \(\frac{1}{2}\) takes care of the double counting since our sum looks at the pair \(i,j\) twice. <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-62" id="solution-62"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-62"><div class="solution solution-like"><p id="p-309">In this case, the Kronecker delta function makes it so that we only count edges within communities.</p></div></div></p>
</li>
</ol>
<p class="continuation">We subtract the expression in question 4(c) from the expression in question 3(b). We then divide by the total number of edges \(m\) (a normalizing factor) to get the modularity</p>
<div class="displaymath">
\begin{equation*}
Q = \frac{1}{2m} \sum_{i}  \sum_{j}  \left( A_{ij} - \frac{k_i k_j}{2m} \right)\, \delta (C^{(i)}, C^{(j)}),
\end{equation*}
</div>
<p class="continuation">which can also be written as</p>
<div class="displaymath">
\begin{equation*}
Q = 	\frac{1}{2m} \sum_{C} \sum_{i \in C} \sum_{j \in C} \left( A_{ij} - \frac{k_i k_j}{2m} \right).	
\end{equation*}
</div></article><article class="exercise exercise-like" id="exercise-43"><h6 class="heading">
<span class="codenumber">6<span class="period">.</span></span><span class="space"> </span><span class="title">Modularity as a Random Walk Measure.</span>
</h6>
<p id="p-310">We can rewrite our modularity equation as</p>
<div class="displaymath">
\begin{equation*}
Q \, = \, \frac{1}{2m} \sum_{C} \sum_{i,j \in C} \left( A_{ij} - \frac{k_i k_j}{2m} \right) 
\,= \,  \sum_{C} \sum_{i,j \in C} \left( \frac{A_{ij}}{k_i} \frac{k_i}{2m}  - \frac{k_i }{2m} \frac{k_j }{2m}  \right)	
\end{equation*}
</div>
<ol id="p-311" class="lower-alpha">
<li id="li-170"><p id="p-derived-li-170">Confirm that this expression is equivalent to<div class="displaymath">
\begin{equation*}
Q \, = \, \sum_{C} \sum_{i,j \in C} \left( P^{\top}_{ij}\pi_i  - \pi_i \pi_j  \right)
\end{equation*}
</div>where \(P = D^{-1} A\) is the random walk transition matrix and \(\pi\) is its stationary distribution, where \(\pi_i=k_{i}/2m\text{.}\) <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-63" id="solution-63"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-63"><div class="solution solution-like"><p id="p-312">This random walk formula for \(Q\) is equivalent to the right hand side of the previous equation for \(Q\)</p></div></div></p></li>
<li id="li-171">
<p id="p-313">Consider a random walk whose distribution has converged to the stationary distribution \(\pi\text{.}\)</p>
<ol class="lower-roman">
<li id="li-172"><p id="p-derived-li-172">Explain why \(\sum_{i,j \in C} P^{\top}_{ij}\pi_i\) is the probability that we are in \(C\) at time \(t\) and \(t+1\text{.}\) <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-64" id="solution-64"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-64"><div class="solution solution-like"><p id="p-314">Given vertex \(i \in C\text{,}\) we are at this vertex with probability \(\pi_i\text{.}\) We then step to a neighbor \(j\) with probability \(p_{ij}\text{,}\) and we only include this in our sum when \(j \in C\text{.}\)</p></div></div></p></li>
<li id="li-173"><p id="p-derived-li-173">Explain why \(\sum_{i,j \in C}  \pi_i \pi_j\) is the probability that we are in \(C\) at time \(t\) and \(t+T\) for very large \(T\text{.}\) <a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-65" id="solution-65"><span class="type">Solution.</span> </a><div class="hidden-content tex2jax_ignore" id="hk-solution-65"><div class="solution solution-like"><p id="p-315">Given vertex \(i \in C\text{,}\) we are at this vertex with probability \(\pi_i\text{.}\) If we walk a large number of steps, then the probability that we are at vertex \(j\) is \(\pi_{j}\text{.}\) We multiply these probabilities to obtain the given probability.</p></div></div></p></li>
</ol>
</li>
<li id="li-174"><p id="p-derived-li-174">Modularity is the difference of the two quantities in part (b). Using this random walk interpretation, why is this difference a measure of community structure?</p></li>
</ol></article></section></section></div></main>
</div>
</body>
</html>
